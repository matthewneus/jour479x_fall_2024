```{r}
library(tidyverse)
library(postmastr)
library(rvest)
library(ggplot2)
library(scales)
library(gt)
library(waffle)

msoc2024 <- read_csv("https://raw.githubusercontent.com/Sports-Roster-Data/mens-soccer/refs/heads/main/combined_rosters_2024.csv")

msoc_div1 <- msoc2024 |>
  filter(division == 'I')
```

```{r}
msoc_div1 <- msoc_div1 |>
  mutate(hometown_cleaned = str_to_upper(str_replace(hometown, "\\.",""))) %>% 
  mutate(hometown_cleaned = str_replace(hometown_cleaned,"\\.","")) %>%
  mutate(hometown_cleaned = str_replace(hometown_cleaned,"/.*","")) %>%
  mutate(hometown_cleaned = str_replace(hometown_cleaned,"\\.$","")) %>%
  mutate(hometown_cleaned = str_replace(hometown_cleaned,",",", ")) %>%
  mutate(hometown_cleaned = str_replace(hometown_cleaned,"-"," ")) %>% 
  mutate(hometown_cleaned = str_squish(hometown_cleaned))

  states_non_standard <- pm_append(type = "state", input = c("SD.", "MASS", "CALIF", "MICH", "NEB", "IND", "MINN", "ORE", "OHIO", "FLA", "MISS", "TENN", "ARIZ", "KAN", "ALA", "OKLA", "WIS", "ILL", " WASH", "ARK", "COLO", "NEV", "CONN", "WISC", "WVA", "DEL", "WYO", "CALI", "LOUIS", "VIRG", "MONT", "PENN", "TEX", "KANS", "NEBR", "IDA", "COL"), output = c("SD", "MA", "CA", "MI", "NE", "IN", "MN", "OR", "OH", "FL", "MS", "TN", "AZ", "KS", "AL", "OK", "WI", "IL", "WA", "AR", "CO", "NV", "CT", "WI", "WV", "DE", "WY", "CA", "LA", "VA", "MT", "PA", "TX", "KS", "NE", "ID", "CO"), locale = "us")

  dict <- pm_dictionary(type='state', case = c("title", "upper", "lower"), append = states_non_standard)

  msoc_div1 <- msoc_div1 %>% pm_identify(var="hometown_cleaned")
  
  parsed <- msoc_div1 %>% 
  pm_identify(var="hometown_cleaned") %>% 
  pm_prep(var="hometown_cleaned", type="street") %>% 
  pm_state_parse(dict)

msoc_div1 <- left_join(msoc_div1, parsed, by="pm.uid")

msoc_div1 <- msoc_div1 %>% separate(hometown, c('hometown', 'homestate'), sep=',', extra='merge')

msoc_div1 <- msoc_div1 |>
  mutate(pm.state = case_when(
    pm.address == '"HUNTINGTON WOODS MICH"' ~ 'MI',
    pm.address %in% c('"FRESNO CALIF"', 'SALINAS CAL', 'LOS ANGELES') ~ 'CA',
    pm.address == '"MAMARONECK NY"' ~ 'NY',
    pm.address == 'BAINBRIDGE ISLAND' ~ 'WA',
    pm.address == 'INDIANAPOLIS' ~ 'IN',
    pm.address %in% c('ORLANDO', 'WEST PALM BEACH FLO') ~ 'FL',
    pm.address %in% c('WINCHESTER VIR', 'ARLINGTON VIR', 'BROAD RUN VIR', 'RICHMOND VIR') ~ 'VA',
    pm.address %in% c("'KAPOLEI HAWAI'I'", "'KAILUA KONA HAWAI'I'", "'HONOLULU HAWAI'I'", "'MAUI HAWAI‘I'", "'HILO HAWAI'I'") ~ 'HI',
    pm.address == 'CINCINNATI' ~ 'OH',
    pm.address == 'PORTLAND OREG' ~ 'OR',
    pm.address == 'LAS VEGAS' ~ 'NV',
    .default = pm.state
  ))
```

```{r}
fifaurl <- "https://inside.fifa.com/fifa-world-ranking/men"
nations <- fifaurl %>%
  read_html() %>%
  html_nodes(xpath = '//*[@id="fifa_ranking_table_wrapper"]/table') %>%
  html_table()

msoc_div1 <- mutate(msoc_div1, country = case_when(!is.na(pm.state) ~ "USA"))

msoc_div1 <- msoc_div1 %>% mutate(temp = sapply(strsplit(msoc_div1$hometown_cleaned, ", ", fixed=TRUE), tail, 1))


msoc_div1 <- msoc_div1 %>% 
  mutate(country = case_when(
      hometown_cleaned == 'WORCESTER, PA' ~ 'USA',
    pm.address %in% c('AABENRAA DENMARK', 'COPENHAGEN DENMARK', 'HILLEROD DENMARK', 'SILKEBORG DENMARK', 'ROSKILDE DENMARK', 'HELLERUP DENMARK', 'ESBJERG DENMARK', 'RANDERS DENMARK', 'HØJE TAASTUP DENMARK', 'ODENSE DENMARK', 'AARHUS DENMARK', 'SOENDERBORG DENMARK', 'NYBORG DENMARK', 'VIBORG DENMARK', 'LYNGS DENMARK', 'SLAGELSE DENMARK', 'RUNGSTED KYST DENMARK', 'AALBORG DENMARK', 'SKOVLUNDE DENMARK', 'SVENDBORG DENMARK', 'TAASTRUP DENMARK', 'GENTOFTE DENMARK', 'VALLENSBAEK DENMARK', 'KALUNDBORG DENMARK', 'HERNING DENMARK', 'HILLERØD DENMARK', 'HORSENS DENMARK', 'GREVE DENMARK', 'FARUM DENMARK', 'VILDBJERG DENMARK', 'HELSINGØR DENMARK', 'BRØNDBY DENMARK', 'GLOSTRUP DENMARK', 'NÆSTVED DENMARK', 'ESPERGÆRDE DENMARK', 'GILLELEJE DENMARK', 'SOLROD STRAND DENMARK') ~ 'DENMARK',
    pm.address %in% c('AALESUND NORWAY', 'ASKER NORWAY', 'VESTBY NORWAY', 'STAVANGER NORWAY', 'MELHUS NORWAY', 'BERGEN NORWAY', 'OLSO NORWAY', 'BRYNE NORWAY', 'BEGBY NORWAY', 'SANDNES NORWAY', 'BAERUM NORWAY', 'DRAMMEN NORWAY', 'EGERSUND NORWAY', 'SOTRA NORWAY', 'KLEPP NORWAY', 'FRAM NORWAY', 'TAU NORWAY', 'FREDRIKSTAD NORWAY', 'LOVENSTAD NORWAY', 'TROMSDALEN NORWAY', 'FINNSNES NORWAY', 'HITRA NORWAY', 'TRANBY NORWAY', 'JESSHEIM NORWAY', 'MOSS NORWAY', 'SKIEN NORWAY', 'NESODDTANGEN NORWAY', 'TRONDHEIM NORWAY', 'BODO NORWAY', 'RENNESØY NORWAY', 'BÆRUM NORWAY', 'PORSGRUNN TELEMARK NORWAY', 'SOGNDAL NORWAY', 'HAUGESUND NORWAY', 'LILLEHAMMER NORWAY', 'RANDABERG NORWAY', 'HOLMESTRAND NORWAY', 'HUSNES NORWAY', 'ORKANGER NORWAY', 'ALESUND NORWAY', 'BODØ NORWAY', 'ELVERUM NORWAY', 'LILLESTRØM NORWAY', 'NORWAY', 'ROSKILDE NORWAY', 'SANDEFJORD NORWAY', 'HVALER NORWAY', 'HASLUM NORWAY', 'VIKESA NORWAY', 'BILLINGSTAD NORWAY', 'LEKNES NORWAY', 'OSLO NORWAY', 'BRYNE NOR') ~ 'NORWAY',
    pm.address %in% c('ACCRA GHANA', 'ACCRA KASOA GHANA', 'KUMASI GHANA', 'SUNYANI GHANA', 'CAPE COAST GHANA', 'MADINA GHANA', 'PORTOR GHANA', 'AWUTU BEREKU GHANA', 'BIBIANI GHANA', 'SEKONDI TAKORADI GHANA', 'SAMPA GHANA', 'TECHIMAN GHANA', 'GREATER ACCRA GHANA', 'HO GHANA', 'ALAJO GHANA', 'TAMALE GHANA', 'BOLGATANGA GHANA', 'TEMA GHANA', 'SOUTHPORT CT & KUMASI GHANA', 'CARPINTERIA CA & ACCRA GHANA') ~ 'GHANA',
    pm.address == 'ST THOMAS, VIRGIN ISLANDS' ~ 'VIRGIN ISLANDS',
    pm.address %in% c('ALAJUELA COSTA RICA', 'SAN JOSÉ COSTA RICA', 'HEREDIA COSTA RICA', 'ATENAS COSTA RICA', 'TARRAZU SAN JOSE COSTA RICA', 'SAN JOSE COSTA RICA', 'SAN CARLOS COSTA RICA', 'SANTA CRUZ COSTA RICA') ~ 'COSTA RICA',
    pm.address == 'FIER ALBANIA' ~ 'ALBANIA',
    pm.address %in% c('CALGARY ALBERTA', 'CHILLIWACK BC', 'KUUJJUAQ QUÉBEC CANADA', 'OAKVILLE ONTARIO CANADA', 'VANCOUVER BRITISH COLUMBIA CANADA', 'TORONTO ONTARIO CANADA', 'RICHMOND HILL ONTARIO CANADA', 'QUEBEC CANADA', 'TORONTO ONTARIO', 'LAVAL QUEBEC CANADA', 'TORONTO ONT', 'OAKVILLE ON', 'TORONTO CANADA', 'MONTREAL QUEBEC CANADA', 'BRAMPTON ONTARIO', 'ST CATHARINES ONTARIO', 'BEAMSVILLE ONTARIO', 'CALEDON ONTARIO CANADA', 'MONTREAL CANADA', 'CALGARY CANADA', 'BRAMPTON ONTARIO CANADA', 'TSAWWASSEN CANADA', 'MARKHAM CANADA', 'MARKHAM ONTARIO', 'MARKHAM ONTARIO CANADA', 'VANCOUVER CANADA', 'QUEBEC CITY CANADA', 'ONTARIO CANADA', 'WINDSOR CANADA', 'KIRKLAND CANADA', 'EDMONTON CANADA', 'AJAX CANADA', 'OAKVILLE ONTARIO', 'AJAX ONTARIO', 'KITCHENER ONTARIO', 'RICHMOND HILL ONTARIO', 'VANCOUVER BRITISH COLUMBIA', 'SURREY BRITISH COLUMBIA', 'GATINEAU QUEBEC', 'MONTREAL QUEBEC', 'QUEBEC CITY QUEBEC CANADA', 'GUELPH ONTARIO', 'HALIFAX NOVA SCOTIA', 'REGINA SASKATCHEWAN CANADA', 'LANGLEY BRITISH COLUMBIA CANADA', 'SCARBOROUGH ONTARIO', 'MISSISSAUGA CANADA', 'ETOBICOKE CANADA', 'MISSISSAUGA ONTARIO CANADA', 'OTTAWA ONTARIO CANADA', 'DORVAL QUEBEC CANADA', 'AJAX ONTARIO CANADA', 'ORANGEVILLE ONTARIO CANADA', 'NOBLETON CANADA', 'ST BRUNO DE MONTARVILLE QUEBEC CANADA', 'CALGARY AB CANADA', 'SHERWOOD PARK ALBERTA CANADA', 'SURREY CANADA', 'ORLEANS CANADA', 'VAUGHAN ON CANADA', 'EDMONTON ALBERTA CANADA', 'OTTAWAY ONTARIO CANADA', 'OAKVILLE CANADA', 'WOODBRIDGE ONTARIO CANADA', 'VICTORIA BRITISH COLUMBIA CANADA', 'HALIFAX CANADA', 'LACHINE QUÉBEC CANADA', 'KITCHENER ONTARIO CANADA', 'BELLE RIVER ONTARIO CANADA', 'SAINT COLOMBAN QUEBEC CANADA', 'MURILLO ONTARIO CANADA', 'ST BASILE-LE-GRAND QUEBEC CANADA', 'EDMONTON ALBERTA CANADA', 'OTTAWA CANADA', 'MISSASSAUGA ONTARIO CANADA', 'MAPLE ONTARIO', 'ETOBICOKE ONTARIO', 'PICKERING ONTARIO', 'LONDON ONTARIO', 'HAMILTON ONTARIO', 'THOROLD ONTARIO', 'NIAGARA FALLS ONTARIO', 'GRIMSBY ONTARIO', 'WINDSOR ONTARIO', 'MISSISSAUGA ONTARIO', 'PICKERING ONTARIO', 'WHITBY ONTARIO', 'BELLEVILLE ONTARIO', 'LASALLE ONTARIO', 'WOODBRIDGE ONTARIO', 'OTTAWA ONTARIO', 'MONTREAL QC', 'MONTREAL QUEBEC CAN', 'MONTREAL QUÉ', 'MASCOUCHE MONTREAL', 'BURNABY BRITISH COLUMBIA', 'VICTORIA BRITISH COLUMBIA', 'PORT COQUITLAM BRITISH COLUMBIA', 'CONTRECOEUR QUEBEC', 'LONGUEUIL QUEBEC', 'LEVIS QUEBEC', 'MONTRÉAL QUEBEC', 'VERDUN QUEBEC CAN', 'VANCOUVER BC', 'BLACK POINT NOVA SCOTIA', 'MARYSVILLE ON', 'ST CATHARINES ON', 'BURNABY BC', 'BRAMPTON ON') ~'CANADA',
    pm.address %in% c('AMIENS FRANCE', 'PARIS FRANCE', 'NOGENT SUR-MARNE FRANCE', 'BOULOGNE BILLANCOURT FRANCE', 'ATTICHES FRANCE', 'LESNEVEN FRANCE', 'MARSEILLE FRANCE', 'ORLEANS FRANCE', 'NIMES FRANCE', 'METZ FRANCE', 'ANGERS FRANCE', 'VILLEJUIF FRANCE', 'TOURS FRANCE', 'GRENOBLE FRANCE', 'MOELAN SUR MER FRANCE', 'BOURGES FRANCE', 'RENNES FRANCE', 'TOULON FRANCE', 'DIJON FRANCE', 'LYON FRANCE', 'QUEMPERVEN FRANCE', 'PONTIVY FRANCE', 'CHARTRES FRANCE', 'VILLIERS LE BEL FRANCE', 'PAU FRANCE', 'HERBLAY SUR SEINE FRANCE', 'SAINT LO FRANCE', 'VALENCE FRANCE', 'CANNES FRANCE', 'CAEN FRANCE', 'PLOEMEUR FRANCE', 'BORDEAUX FRANCE', 'NICE FRANCE', 'PÉRONNE FRANCE', 'MONTPELLIER FRANCE', 'BAZIEGE FRANCE', 'REIMS FRANCE', 'NANTES FRANCE', 'ALLAUCH FRANCE', 'VOLCKERINCKHOVE FRANCE', 'LE MANS FRANCE', 'NANCY FRANCE', 'STRASBURG FRANCE', 'CERVIONI FRANCE', 'GUINGAMP FRANCE', 'ASNIÈRES SUR-SEINE FRANCE', 'STRASBOURG FRANCE', 'CASSIS FRANCE', 'MORZINE FRANCE', 'ELNE FRANCE', 'CLERMONT FERRAND FRANCE', 'LOULANS VERCHAMP FRANCE', 'AUXERRE FRANCE', 'LES ABYMES FRANCE', 'LONGWY FRANCE', 'FONTENAY SOUS BOIS FRANCE', 'AIX EN-PROVENCE FRANCE', 'CRÉTEIL FRANCE', 'LA TALAUDIERE FRANCE', 'LA CRAU FRANCE', 'BREST FRANCE', 'CRÉON FRANCE', 'CRETEIL FRANCE', 'GUIVAPAS FRANCE') ~ 'FRANCE',
    pm.address %in% c('SANTA FE ARGENTINA', 'BUENOS AIRES ARGENTINA', 'MERLO SAN LUIS ARGENTINA', 'LA PLATA ARGENTINA', 'TANDIL ARGENTINA', 'ROSARIO ARGENTINA', 'CORDOBA ARGENTINA', 'JUNIN ARGENTINA', 'PUERTO MADRYN ARGENTINA', 'PARANÁ ENTRE RÍOS ARGENTINA', 'ARATA ARGENTINA', 'NUÑEZ ARGENTINA', 'MENDOZA ARGENTINA') ~ 'ARGENTINA',
    pm.address %in% c('ASUNCIÓN PARAGUAY', 'ASUNCION PARAGUAY') ~ 'PARAGUAY',
    pm.address %in% c('ADELAIDE AUSTRALIA', 'BUDERIM QUEENSLAND AUSTRALIA', 'CENTRAL COAST AUSTRALIA', 'HOWRAH AUSTRALIA', 'WOLLONGONG AUSTRALIA', 'MELBOURNE AUSTRALIA', 'BRISBANE, QUEENSLAND, AUSTRALIA', 'SYDNEY AUSTRALIA', 'CASTLE HILL AUSTRALIA', 'PERTH AUSTRALIA', 'CANBERRA AUSTRALIA', '"BRISBANE, AUSTRALIA"', 'REDHEAD NEW SOUTH WALES', 'WANNANUP WESTERN AUSTRALIA', '"BRISBANE AUSTRALIA"', 'NEWCASTLE AUSTRALIA', 'BRISBANE QUEENSLAND AUSTRALIA') ~ 'AUSTRALIA',
    pm.address %in% c('NEUFELD AUSTRIA', 'STYRIA AUSTRIA', 'GRAZ AUSTRIA', 'LUSTENAU AUSTRIA', 'OBERTRUM AM SEE AUSTRIA', 'SALZBURG AUSTRIA', 'KLAGENFURT AUSTRIA', 'AUSTRIA', 'VIENNA AUSTRIA', 'FEFFERNITZ AUSTRIA', 'KOSTENDORG AUSTRIA', 'KOSTENDORF AUSTRIA', 'SEEHAM AUSTRIA') ~ 'AUSTRIA',
    pm.address %in% c('NASSAU BAHAMAS', 'NASSAU NEW PROVIDENCE THE BAHAMAS') ~ 'BAHAMAS',
    pm.address %in% c('BANBURY ENGLAND', 'LEICESTER ENGLAND', 'ROTHERHAM ENGLAND', 'GODALMING ENGLAND', 'CAMBRIDGE ENGLAND', 'BIRMINGHAM ENGLAND', 'LEEDS ENGLAND', 'STRATFORD UPON-AVON UK', 'MILTON KEYNES ENGLAND', 'LONDON ENGLAND', 'IPSWICH ENGLAND', 'NEWCASTLE ENGLAND', 'KENT ENGLAND', 'CARLISLE ENGLAND', 'WHITCHURCH ENGLAND', 'CHESTER UNITED KINGDOM', 'NOTTINGHAM ENGLAND', 'PLYMOUTH UNITED KINGDOM', 'CHESTER ENGLAND', 'SURREY ENGLAND', 'SHEFFIELD ENGLAND', 'MANCHESTER ENGLAND', 'LONDON UNITED KINGDOM', 'OLDHAM MANCHESTER UNITED KINGDOM', 'REDCAR ENGLAND', 'WAKEFIELD UNITED KINGDOM', 'BRIDLINGTON UNITED KINGDOM', 'ADDINGHAM UNITED KINGDOM', 'SURREY UNITED KINGDOM', 'STOCKPORT ENGLAND', 'VIRGINIA WATER ENGLAND', 'YORK ENGLAND', 'MIDDLESBROUGH ENGLAND', 'MAIDENHEAD ENGLAND', 'HULL ENGLAND', 'BROXBOURNE ENGLAND', 'SHREWSBURY ENGLAND', 'SWINDON ENGLAND', 'YEOVIL ENGLAND', 'SOUTH LONDON ENGLAND', 'BLACKPOOL ENGLAND', 'EPSOM EWELL ENGLAND', 'SLOUGH ENGLAND', 'PLYMOUTH ENGLAND', 'EASTBOURNE EAST SUSSEX', 'PETERBOROUGH ENGLAND', 'BURY ENGLAND', 'FILEY ENGLAND', 'HARTLEPOOL ENGLAND', 'BRISTOL ENGLAND', 'COBHAM ENGLAND', 'BASINGSTOKE ENGLAND', 'WIDNES CHESHIRE ENGLAND', 'BASINGSTOKE ENGLAND', 'REPTON ENGLAND', 'CHESIRE ENGLAND', 'HARROW ENGLAND', 'BAWDSEY ENGLAND', 'GREAT BARFORD BEDFORDSHIRE ENGLAND', 'LANCASTER ENGLAND', 'FROME ENGLAND', 'ESSEX ENGLAND', 'NEWTON ENGLAND', 'KELSALL ENGLAND', 'WIRRAL ENGLAND', 'LEEK ENGLAND', 'CUFFLEY ENGLAND', 'BEDFORD ENGLAND', 'PENZANCE ENGLAND', 'ASTLEY GREATER MANCHESTER ENGLAND', 'MACCLESFIELD ENGLAND', 'SOUTHEND ON SEA ENGLAND', 'CORNWALL ENGLAND', 'HIGH WYCOMBE ENGLAND', 'DERBYSHIRE ENGLAND', 'LIVERPOOL ENGLAND', 'YORKSHIRE ENGLAND', 'ALDERSHOT ENGLAND', 'NORWICH ENGLAND', 'CHRISTCHURCH ENGLAND', 'WORCESTER', 'WIGAN ENGLAND', 'THORNTON HEATH ENGLAND', 'CROWTHORNE ENGLAND', 'HERTFORDSHIRE ENGLAND', 'CHELTENHAM ENGLAND', 'EASTBOURNE ENGLAND', 'MALDON ENGLAND', 'BRIGHOUSE ENGLAND', 'SOUTHAMPTON ENGLAND', 'ST HELENS ENGLAND', 'COLCHESTER ENGLAND', 'BURNLEY ENGLAND', 'HAMPSHIRE ENGLAND', 'BRACKNELL ENGLAND', 'RAWTENSTALL ENGLAND', 'BATH ENGLAND', 'LITTLEHAMPTON ENGLAND', 'WEDNESBURY ENGLAND', 'ORWELL ENGLAND', 'NEWTON ABBOT ENGLAND', 'LOUGHBOROUGH ENGLAND', 'LEEDS UNITED KINGDOM', 'STOCKPORT UNITED KINGDOM', 'COBHAM UNITED KINGDOM', 'ESSEX UNITED KINGDOM', 'CREWE UNITED KINGDOM', 'CAMBRIDGE UNITED KINGDOM', 'SOMERSET UNITED KINGDOM', 'PORTSMOUTH UNITED KINGDOM', 'BEWDLEY WORCESTERSHIRE UK', 'HERTFORDSHIRE UK', 'HERTFORDSHIRE GB ENG') ~ 'ENGLAND',
    pm.address %in% c('BATTAGLIA TERME ITALY', 'GENOVA ITALY', 'TRENTO ITALY', 'MILAN ITALY', 'TURIN ITALY', 'FOSSACESIA ITALY', 'ST GEORGEN ITALY', 'BOVILLE ERNICA ITALY', 'GENOA ITALY', 'CARDITO ITALY', 'LIGURIA ITALY', 'MANZANO ITALY', 'BORGOSESIA ITALY', 'MODENA ITALY', 'PINEROLO ITALY', 'MARTINA FRANCA ITALY', 'VERONA ITALY', 'FERMO ITALY', 'GIULIA ITALY', 'CUNEO ITALY', 'PERUGIA ITALY', 'ROME ITALY', 'SANTA GIUSTA ITALY', 'CREMA ITALY', 'CASSINO ITALY', 'BOLOGNA ITALY', 'MASSA ITALY', 'TORINO ITALY', 'BARI ITALY', 'ALBENGA ITALY', 'FAVARA ITALY', 'ROMA ITALY') ~ 'ITALY',
    pm.address %in% c('A CORUÑA SPAIN', 'ALCOY SPAIN', 'FOGARS DE MONTCLÚS BARCELONA','BARCELONA SPAIN', 'BILBAO SPAIN', 'ZARAGOZA SPAIN', 'SAN SEBASTIAN SPAIN', 'ALBORACHE SPAIN', 'VALENCIA ESPAÑA', 'VALENCIA SPAIN', 'ARES DEL MAESTRAT SPAIN', 'DELTEBRE CATALONIA SPAIN', 'SANTANDER CANTABRIA SPAIN', 'MADRID SPAIN', 'CARCAIXENT SPAIN', 'MALLORCA SPAIN', 'CASTELLON SPAIN', 'BURGOS SPAIN', 'VITORIA SPAIN', 'TERUEL SPAIN', 'ALICANTE SPAIN', 'EIBAR SPAIN', 'VILLARREAL SPAIN', 'PAU CATALUNYA SPAIN', 'VIGO SPAIN', 'VILLENA SPAIN', 'SEVILLE SPAIN', 'TERRASSA SPAIN', 'LLEIDA SPAIN', 'CASTELLAR DEL VALLES SPAIN', 'RIUDOMS SPAIN', 'ELCHE ALICANTE SPAIN', 'GALICIA SPAIN', 'GIJÓN SPAIN', 'VALLIRANA SPAIN', 'ELCHE SPAIN', 'MURCIA SPAIN', 'CASTELLÓN DE LA PLANA SPAIN', 'ALMERIA SPAIN', 'CORUÑA SPAIN', 'BENICARLO SPAIN', 'MATARO SPAIN', 'CASAS BAJAS SPAIN', 'GUADALAJARA SPAIN', 'TOLEDO SPAIN', 'FERROL SPAIN', 'PAMPLONA SPAIN', 'SANTANDER SPAIN', 'SALAMANCA SPAIN', 'SEVILLA SPAIN', 'CÁDIZ SPAIN', 'LA CORUNA SPAIN', 'BURRIANNA SPAIN', 'SEDAVI SPAIN', 'SILLA SPAIN', 'BADALONA SPAIN', 'REUS SPAIN', 'BURRIANA SPAIN', 'GETAFE SPAIN', 'GIRONA SPAIN', 'GRAN CANARIA SPAIN', 'CASTELLÓN SPAIN', 'LAS ROZAS SPAIN', 'LEON SPAIN', 'ARROYOMOLINOS SPAIN', 'CARTAGENA SPAIN', 'VALLADOLID SPAIN', 'MECO SPAIN', 'GENOVES SPAIN', 'MIRA SPAIN', 'PRADEJON SPAIN', 'SAGUNTO SPAIN', 'A CORUNA SPAIN', 'ALCALÁ DE GUADAÍRA SPAIN', 'SAN PEDRO DE ALCANTARA SPAIN', 'SEVILLA ESP', 'MADRID ESP', 'GETAFE MADRID', 'ENGUERA VALENCIA') ~ 'SPAIN',
    pm.address %in% c('TAKAHAMA JAPAN', 'MIYAGI JAPAN', 'TOKYO JAPAN', 'SAITAMA JAPAN', 'FUJIOKA JAPAN', 'OSAKA JAPAN', 'NERIMA KU JAPAN', 'GIFU JAPAN', 'KANAGAWA JAPAN', 'HITACHI JAPAN', 'KOBE JAPAN', 'IBARAKI JAPAN', 'NARA JAPAN', 'HIROSHIMA JAPAN', 'NISHINOMIYA HYOGO JAPAN', 'KOBE CITY JAPAN', 'HYOGO JAPAN', 'YOKOHAMA JAPAN', 'FUKUOKA JAPAN', 'NAGANO JAPAN', 'AICHI JAPAN', 'RYUGASAKI JAPAN', 'HOKKAIDO JAPAN', 'KANAZAWA JAPAN', 'YOKOSUKA JAPAN', 'KAGOSHIMA JAPAN', 'MATSUMOTO NAGANO JAPAN', 'MAEBASHI JAPAN', 'NERIMA TOKYO JAPAN', 'KAMAKURA KANAGAWA JAPAN', 'KAWAGUCHI JAPAN', 'MIE JAPAN', 'KAWASAKI JAPAN', 'TOYOHASHI JAPAN', 'HYOGO JAPAN', 'SENDAI JAPAN', 'TOYOHASHI AICHI JAPAN', 'SHONAN JAPAN', 'SAGAMIHARA JAPAN', 'FUJISAWA JAPAN', 'SAGAMIHARA CITY JAPAN') ~ 'JAPAN',
    pm.address %in% c('KALMAR SWEDEN', 'VAXJO SWEDEN', 'ANGELHOLM SWEDEN', 'VAERMDOE SWEDEN', 'NYKOPING SWEDEN', 'STOCKHOLM SWEDEN', 'MALMO SWEDEN', 'BORAS SWEDEN', 'DJURSHOLM SWEDEN', 'VARGARDA SWEDEN', 'VAXHOLM SWEDEN', 'TÄBY SWEDEN', 'GOTHENBURG SWEDEN', 'HOSSLEHOLM SWEDEN', 'HUSKVARNA SWEDEN', 'HELSINGBORG SWEDEN', 'HASSLEHOLM SWEDEN', 'GOTTSUNDA SWEDEN', 'ÖJERSJÖ SWEDEN', 'VÄSTERÅS SWEDEN', 'SUNDBYBERG SWEDEN', 'TORSLANDA SWEDEN', 'TRELLEBORG SWEDEN', 'GLUMSLOV SWEDEN', 'UPPSALA SWEDEN', 'VÄSTRA GÖTALAND SWEDEN', 'HALMSTAD SWEDEN', 'BORÅS SWEDEN', 'ÖREBRO SWEDEN', 'SUNDSVALL SWEDEN', 'KARLSKRONA SWEDEN', 'GÄVLE SWEDEN', 'HÖLLVIKEN SWEDEN', 'SPÅNGA SWEDEN', 'ASARUM SWEDEN', 'UPPASALA SWEDEN') ~ 'SWEDEN',
    pm.address %in% c('REYKJAVIK ICELAND', 'HAFNARFJORDUR ICELAND', 'VESTMANNAEYJAR ICELAND', 'KEFLAVIK ICELAND', 'HAFNARFJOROUR ICELAND', 'REYKJAVÍK ICELAND', 'GARÐABÆR ICELAND', 'HAFNARFJÖRÐUR ICELAND', 'AKRANES ICELAND', 'AKUREYRI ICELAND', 'GARÐABAER ICELAND', 'DALVIK ICELAND', 'REYKJANESBÆR ICELAND', 'SELFOSS ICELAND', 'GARDABAER ICELAND', 'KOPAVOGUR ICELAND', 'KÓPAVOGUR ICELAND', 'HAFARFJÖROUR ICELAND', 'GRAFARVOGUR ICELAND', 'HVOLSVOLLUR ICELAND', 'REYOARFJOROUR ICELAND', 'ARBÆR ICELAND', 'HAFNARFFJÖROUR ICELAND', 'HAFNARFJÖROUR ICELAND') ~ 'ICELAND',
    pm.address %in% c('CASABLANCA MOROCCO', 'BENI MALLAI MOROCCO') ~ 'MOROCCO',
    pm.address %in% c('AMSTERDAM NETHERLANDS', 'DONGEN NOORD BRABANT NETHERLANDS', 'GELDROP NETHERLANDS', 'EMMEN NETHERLANDS', 'AERDENHOUT NETHERLANDS', 'UTRECHT NETHERLANDS', 'MILLINGEN AAN DE RIJN NETHERLANDS', 'VOERENDAAL NETHERLANDS', 'UTRECHT THE NETHERLANDS', 'AMSTELVEEN NETHERLANDS', 'URSEM THE NETHERLANDS', 'NIJMEGEN NETHERLANDS', 'AMSTERDAM THE NETHERLANDS', 'EINDHOVEN NETHERLANDS', 'THE HAGUE NETHERLANDS', 'WOERDEN NETHERLANDS', 'BERGHAREN NETHERLANDS', 'GRONINGEN NETHERLANDS', 'STEENDEREN NETHERLANDS', 'HAARLEM NOORD HOLLAND NETHERLANDS', 'BAARN NETHERLANDS', 'HOUTON NETHERLANDS', 'DE MEERN NETHERLANDS', 'NIEUW VENNEP NETHERLANDS', 'CHAAM NETHERLANDS', 'WESTERVOORT NETHERLANDS', 'HENGELO NETHERLANDS', 'CAPELLE AAN DEN IJSSEL NETHERLANDS', 'STEENSEL NETHERLANDS', 'KUDELSTAART NETHERLANDS', 'ROTTERDAM NETHERLANDS', 'HOUTEN NETHERLANDS', 'SINT ANNAPAROCHIE') ~ 'NETHERLANDS',
    pm.address %in% c('SAO PAULO BRAZIL', 'PORTO ALEGRE BRAZIL', 'RONDON DO PARA BRAZIL', 'RIO DE JANEIRO BRAZIL', 'ITUPEVA BRAZIL', 'SALVADOR BRAZIL', 'SÃO PAULO BRAZIL', 'FLORIANOPÓLIS BRAZIL', 'FOZ DO IGUAÇU BRAZIL', 'BAURU BRAZIL', 'CAMPO BOM BRAZIL', 'SANTOS BRAZIL', 'CAXAMBU BRAZIL', 'PARANÁ BRAZIL', 'BELO HORIZONTE BRAZIL', 'CONCORDIA BRAZIL', 'SALVADOR BAHIA BRAZIL', 'RIBEIRAO PRETO BRAZIL', 'ATIBAIA SP BRAZIL', 'TOLEDO BRAZIL', 'SÃO PAOLO BRAZIL', 'SANTO ANDRE BRAZIL', 'MORRETES BRAZIL', 'SAO PAOLO BRAZIL', 'INDAIATUBA BRAZIL', 'CURITIBA BRAZIL', 'FORTALEZA BRAZIL', 'SOROCABA BRAZIL', 'MACEIÓ BRAZIL', 'TAUBATE BRAZIL', 'GOIÂNIA BRAZIL', 'CAMPINAS BRAZIL', 'SANTOS SAO PAOLO BRAZIL', 'FORTALEZA BRAZIL') ~ 'BRAZIL',
    pm.address %in% c('LIMASSOL CYPRUS', 'NICOSIA CYPRUS', 'LARNACA CYPRUS', 'PARALIMNI CYPRUS', 'LEIVADIA CYPRUS', 'FAMAGUSTA CYPRUS') ~ 'CYPRUS',
    pm.address %in% c('BJELOVAR CROATIA', 'POREC CROATIA', 'ZADAR CROATIA', 'ZAGREB CROATIA') ~ 'CROATIA',
    pm.address %in% c('BERLIN GERMANY', 'BONN GERMANY', 'FRANKFURT GERMANY', 'STOCKSTADT GERMANY', 'BERGISCH GLADBACH GERMANY', 'DUSSELDORF GERMANY', 'FREIBURG GERMANY', 'ERFURT GERMANY', 'HAMBURG GERMANY', 'BUERSTADT GERMANY', 'COLOGNE GERMANY', 'DUISBURG GERMANY', 'BADEN WURTTEMBERG GERMANY', 'RATEKAU GERMANY', 'KIEL GERMANY', 'INGOLSTADT GERMANY', 'REUTLINGEN GERMANY', 'ESSEN GERMANY', 'FURTH GERMANY', 'FRIEDBERG GERMANY', 'LINDLAR GERMANY', 'SCHILDOW GERMANY', 'HEIDENHEIM GERMANY', 'NEUMÜNSTER GERMANY', 'LEIPZIG GERMANY', 'ROSTOCK GERMANY', 'KASSEL GERMANY', 'KIRCHZELL GERMANY', 'GEINHAUSEN GERMANY', 'BREMEN GERMANY', 'STUTTGART GERMANY', 'WIESBADEN GERMANY', 'REGENSBURG GERMANY', 'WUPPERTAL GERMANY', 'OBERKOTZAU GERMANY', 'FLENSBURG GERMANY', 'BAD HONNEF GERMANY', 'STUKENBROCK GERMANY', 'PADERBORN GERMANY', 'BUCHEN GERMANY', 'WÖLFERSHEIM GERMANY', 'TRIER GERMANY', 'FRANKFURT AM MAIN HESSE GERMANY', 'KREFELD GERMANY', 'DÜSSELDORF GERMANY', 'KÖNIGSTEIN IM TAUNUS GERMANY', 'HEIDELBERG GERMANY', 'PULHEIM GERMANY', 'GELSENKIRCHEN GERMANY', 'ANDERNACH GERMANY', 'KAARST GERMANY', 'WELVER GERMANY', 'FREILASSING GERMANY', 'BIELEFELD GERMANY', 'NETTETAL GERMANY', 'EUTIN GERMANY', 'MUNICH BAVARIA GERMANY', 'WRESTEDT GERMANY', 'KARBEN GERMANY', 'MARPINGEN GERMANY', 'WORMS GERMANY', 'ELTVILLE GERMANY', 'GRÖBENZELL GERMANY', 'MUNICH GERMANY', 'EMMENDINGEN GERMANY', 'GOMARINGEN GERMANY', 'LANGENAU GERMANY', 'ALTENKIRCHEN GERMANY', 'DORTMUND GERMANY', 'BUCHHOLZ GERMANY', 'AACHEN GERMANY', 'OBERSTENFELD GERMANY', 'AMBERG GERMANY', 'EBERSBACH GERMANY', 'WEYHE GERMANY', 'HERBOLZHEIM GERMANY', 'TRAUNSTEIN GERMANY', 'KONGIGSWINTER GERMANY', 'TETTNANG GERMANY', 'BENNDOEF GERMANY', 'GRUNSFELD GERMANY', 'UNNA GERMANY', 'NEUSS GERMANY', 'KAISERSLAUTERN GERMANY', 'ULM GERMANY', 'HIELBRONN GERMANY', 'DONAUECHINGEN GERMANY', 'KONIGSWINTER GERMANY', 'BENNDORF GERMANY', 'MANNHEIM GERMANY', 'OBERSTDORF GERMANY', 'BRUNSWICK GERMANY', 'BOPPARD GERMANY', 'APENSEN GERMANY', 'OSTERCAPPELN GERMANY', 'HANNOVER GERMANY', 'DRESDEN GERMANY', 'ROTTACH EGERN GERMANY', 'BRUGGEN GERMANY', 'FRANKFURT AM MAIN GERMANY', 'FRANKENBERG GERMANY', 'WENDEBURG GERMANY', 'MÖNCHENGLADBACH GERMANY', 'ALSDORF GERMANY', 'BAD SODEN AM TAUNUS GERMANY', 'NUREMBERG GERMANY', 'BAYREUTH GERMANY', 'RANTINGEN GERMANY', 'DONAUESCHINGEN GERMANY', 'BERGISCH GLADBACH') ~ 'GERMANY',
    pm.address == 'YAOUNDE CAMEROON' ~ 'CAMEROON',
    pm.address %in% c('WAIPU NEW ZEALAND', 'WELLINGTON NEW ZEALAND', 'AUCKLAND NEW ZEALAND', 'QUEENSTOWN NEW ZEALAND', 'HASTINGS NEW ZEALAND', 'NEW PLYMOUTH NEW ZEALAND', 'DAYS BAY NEW ZEALAND', 'NELSON NEW ZEALAND', 'CHRISTCHURCH NZ', 'NEW ZEALAND', 'ALEXANDRA NEW ZEALAND', 'CHRISTCHURCH NEW ZEALAND') ~ 'NEW ZEALAND',
    pm.address %in% c('PUEBLA MEXICO', 'MEXICO CITY MEXICO', 'VALLE DE SANTIAGO MEXICO', 'MONTERREY MEXICO', 'JALISCO GUADALAJARA MEXICO', 'JALISCO MEXICO', 'LOS CABOS MEXICO', 'CHIHUAHUA MEXICO', 'CELAYA MEXICO', 'GUADALAJARA MEXICO', 'QUERÉTARO CITY MEXICO', 'CÓRDOBA MEXICO', 'CANCUN MEXICO', 'TOLUCA MEXICO', 'MONCLOVA MEXICO', 'REYNOSA TAMAULIPAS MEXICO', 'ZAPOPAN MEXICO', 'VERACRUZ MEXICO', 'MEXICALI MEXICO', 'MERIDA MEXICO', 'SAN MIGUEL DE ALLENDE MEXICO', 'JUAREZ CHIHUAHUA MEXICO', 'TIJUANA BC MEXICO', 'VICTORIA TAMAULIPAS MEXICO', 'TOLUCA MEXICO', 'MORELIA MICHOACAN MEXICO', 'QUERETARO MEXICO', 'CIUDAD JUAREZ MEXICO') ~ 'MEXICO',
    pm.address %in% c('SANTIAGO CHILE', 'OSORNO CHILE', 'TALCA CHILE') ~ 'CHILE',
    pm.address %in% c('TEL AVIV ISRAEL', 'PEKAH TIKVA ISRAEL', 'HERZLIYA ISRAEL', 'RAMAT GAN ISRAEL', 'YEHUD ISRAEL', 'GANEI TIKVA ISRAEL', 'RAANANA ISRAEL', 'JERUSALEM ISRAEL', 'KIRYAT ATA ISRAEL', 'KEFAR HA NAGID ISRAEL', 'MODIIN ISRAEL', 'KADIMA ISRAEL', 'RAMAT HASHARON ISREAL', 'RAMLE ISRAEL', 'GIVATAYIN ISRAEL', 'HOD HASHARON ISRAEL', 'BEIT HANAN ISRAEL', 'HETZLIYA ISRAEL', 'HOLON ISRAEL', 'RAMAT HASHARON ISRAEL', 'GIVATAYIM ISRAEL') ~ 'ISRAEL',
    pm.address == 'COSTA DEL ESTE PANAMA' ~ 'PANAMA',
    pm.address %in% c('KAMPENHOUT BELGIUM', 'BRUXELLES BELGIUM','BRUSSELS BELGIUM', 'ANTWERP BELGIUM') ~ 'BELGIUM',
    pm.address %in% c('PRAIA DA VITORIA PORTUGAL', 'TORRESS NOVAS', 'CASCAIS PORTUGAL', 'SANTA MARIA DE FARIA PORTUGAL', 'TORRES NOVAS PORTUGAL', 'BRAGA PORTUGAL', 'RIACHOS PORTUGAL', 'FAMALICAO PORTUGAL', 'PONTA DELGADA PORTUGAL', 'POMBAL PORTUGAL', 'ALGARVE PORTUGAL', 'PORTO PORTUGAL', 'MIRA DE AIRE PORTUGAL', 'FARO PORTUGAL', 'COIMBRA PORTUGAL', 'FUNCHAL PORTUGAL', 'LISBON PORTUGAL', 'CONSTÂNCIA PORTUGAL', 'ARRENTELA PORTUGAL', 'BARCELOS PORTUGAL', 'TORRES VEDRAS PORTUGAL', 'EVORA PORTUGAL', 'BARREIRO PORTUGAL', 'VILA DO CONDE PORTUGAL', 'LISBOA PORTUGAL', 'LISBON PORTUGAL', 'SERRA DEL REI PORTUGAL', 'POVOA DE VARZIM PORTUGAL', 'ESPINHO PORTUGAL', 'VILA NOVA DE GAIA PORTUGAL', 'LOULÉ PORTUGAL', 'SETUBAL PORTUGAL', 'ESPINHO PORTUGLA', 'MACHICO MADEIRA ISLAND', 'LISBON PURTUGAL') ~ 'PORTUGAL',
    pm.address == 'QUTHING LESOTHO' ~ 'LESOTHO',
    pm.address %in% c('KINVARA IRELAND', 'GALWAY IRELAND', 'DUBLIN REPUBLIC OF IRELAND', 'ATHY IRELAND', 'DONEGAL IRELAND', 'DUBLIN IRELAND', 'CAVAN IRELAND', 'DERRY NORTHERN IRELAND', 'DONERAILE IRELAND', 'SLIGO IRELAND', 'WESTMEATH IRELAND', 'DROGHEDA IRELAND', 'ARDEE IRELAND', 'MEATH IRELAND') ~ 'IRELAND',
    pm.address %in% c('BOGOTA COLOMBIA', 'MEDELLÍN COLOMBIA', 'MEDELLIN COLOMBIA', 'CALI COLOMBIA', 'ARMENIA COLOMBIA') ~ 'COLOMBIA',
    pm.address %in% c('BO TOWN SIERRA LEONE', 'FREETOWN SIERRA LEONE', 'KENEMA SIERRA LEONE') ~ 'SIERRA LEONE',
    pm.address %in% c('SANDWEILER LUXEMBOURG', 'NIEDERDONVEN LUXEMBOURG') ~ 'LUXEMBOURG',
    pm.address %in% c('ZURICH SWITZERLAND', 'THUN SWITZERLAND', 'ARLESHEIM BL SWITZERLAND', 'GENEVA SWITZERLAND', 'LAUSANNE SWITZERLAND', 'VISP SWITZERLAND', 'WINTERTHUR SWITZERLAND', 'FRAUENFELD SWITZERLAND', 'THALWIL SWITZERLAND') ~ 'SWITZERLAND',
    pm.address %in% c('KINSHASA CONGO', 'KINSHASA DEMOCRATIC REPUBLIC OF THE CONGO') ~ 'DR CONGO',
    pm.address == 'BRIDGETOWN BARBADOS' ~ 'BARBADOS',
    pm.address %in% c('MOSCOW RUSSIA', 'KRASNODAR RUSSIA') ~ 'RUSSIA',
    pm.address %in% c('FARRA FENNI GAMBIA', 'BANJUL THE GAMBIA') ~ 'GAMBIA',
    pm.address %in% c('MARIBOR SLOVENIA', 'JESENICE SOLVENIA', 'JESENICE SLOVENIA', 'NOVA GORICA SLOVENIA', 'LJUBLJANA SLOVENIA', 'DOMZALE SLOVENIA') ~ 'SLOVENIA',
    pm.address %in% c('ROXBOROUGH TOBAGO', 'SAN FERNANDO TRINIDAD') ~ 'TRINIDAD AND TOBAGO',
    pm.address %in% c('NAIROBI KENYA', 'KAPENGURIA KENYA') ~ 'KENYA',
    pm.address %in% c('MONTEGO BAY JAMAICA', 'KINGSTON JAMAICA', 'JAMAICA', 'LILLIPUT JAMAICA', 'HANOVER JAMAICA', 'ST THOMAS JAMAICA', 'WATERFORD JAMAICA') ~ 'JAMAICA',
    pm.address == 'LOMÉ TOGO' ~ 'TOGO',
    pm.address %in% c('KAMPALA UGANDA', 'LIRA UGANDA') ~ 'UGANDA',
    pm.address %in% c('TÖRÖKBÁLINT HUNGARY', 'BUDAPEST HUNGARY', 'PILISCSABA HUNGARY', 'GYOR HUNGARY') ~ 'HUNGARY',
    pm.address %in% c('BELGRADE SERBIA', 'NOVA PAZOVA SERBIA', 'NOVA SAD SERBIA', 'BEOGRAD SERBIA') ~ 'SERBIA',
    pm.address == 'SKOPJE NORTH MACEDONIA' ~ 'NORTH MACEDONIA',
    pm.address %in% c('GUAYAQUIL ECUADOR', 'SAMBORONDON ECUADOR', 'PORTVEIJO ECUADOR') ~ 'ECUADOR',
    pm.address %in% c('TEGUCIGALPA HONDURAS', 'CORTES HONDURAS', 'ROATAN HONDURAS') ~ 'HONDURAS',
    pm.address %in% c('MERIDA VENEZUELA', 'CARACAS VENEZUELA', 'BARQUISMETO LARA VENEZUALA', 'VALENCIA VENEZUELA', 'VALERA VENEZUELA', 'BARQUISIMETO LARA VENEZUELA') ~ 'VENEZUELA',
    pm.address %in% c('PRAGUE CZECH REPUBLIC', 'PILSEN CZECH REPUBLIC') ~ 'THE CZECH REPUBLIC',
    pm.address %in% c('THRAKOMAKEDONES ATHENS GREECE', 'AGIOS STEFANOS ATHENS GREECE', 'THESSALONIKI GREECE') ~ 'GREECE',
    pm.address %in% c('GAUTENG SOUTH AFRICA', 'ROODEPOORT SOUTH AFRICA', 'CAPE TOWN SOUTH AFRICA', 'JOHANNESBURG SOUTH AFRICA', 'PRETORIA SOUTH AFRICA', 'SOUTPAN SOUTH AFRICA', 'CAPETOWN SOUTH AFRICA', 'EAST LONDON SOUTH AFRICA') ~ 'SOUTH AFRICA',
    pm.address == 'SANTO DOMINGO DOMINICAN REPUBLIC' ~ 'DOMINICAN REPUBLIC',
    pm.address %in% c('MONROVIA LIBERIA', 'MONTSERRADO LIBERIA') ~ 'LIBERIA',
    pm.address %in% c('OGUN NIGERIA', 'ERUWA NIGERIA') ~ 'NIGERIA',
    pm.address == 'LIMA PERU' ~ 'PERU',
    pm.address == 'MAPUTO MOZAMBIQUE' ~ 'MOZAMBIQUE',
    pm.address %in% c('ODESSA UKRAINE', 'RIVNE UKRAINE', 'KYIV UKRAINE', 'KHARKIV UKRAINE', 'LUHANSK UKRAINE') ~ 'UKRAINE',
    pm.address %in% c('YANGSAN SI SOUTH KOREA', 'BUSAN SOUTH KOREA', 'DAEJEON SOUTH KOREA', 'PAJU SI KOREA', 'SEOUL KOREA', 'SEOUL SOUTH KOREA', 'MUNGYEONG SI SOUTH KOREA', 'INCHEON SOUTH KOREA', 'GURI SI SOUTH KOREA', 'GIMPO SOUTH KOREA') ~ 'SOUTH KOREA',
    pm.address == 'ULAANBAATAR MONGOLIA' ~ 'MONGOLIA',
    pm.address %in% c('WARSZAWA POLAND', 'BYDGOSZCZ POLAND', 'PSARY POLAND', 'WARSAW POLAND', 'POZNAN POLAND') ~ 'POLAND',
    pm.address %in% c('ABERDEEN SCOTLAND', 'GLASGOW SCOTLAND', 'LARKHALL SCOTLAND', 'KINROSS SCOTLAND', 'WEST KILBRIDE SCOTLAND', 'PERTH SCOTLAND', 'GOUROCK SCOTLAND') ~ 'SCOTLAND',
    pm.address %in% c('DAKAR SENEGAL', 'POUT SENEGAL', 'RUFISQUE DAKAR SENEGAL', 'MBOUR SENEGAL', 'COLOBANE DAKAR SENEGAL', 'THIES SENEGAL', 'KAOLACK SENEGAL') ~ 'SENEGAL',
    pm.address %in% c('MUYOVOZI TANZANIA', 'KASULU TANZANIA') ~ 'TANZANIA',
    pm.address %in% c('GEORGE TOWN CAYMAN ISLANDS', 'BODDEN TOWN CAYMAN ISLANDS', 'GRAND CAYMAN CAYMAN ISLANDS', 'GEORGETOWN GRAND CAYMAN ISLANDS', 'GEORGE TOWN GRAND CAYMAN', 'CAYMAN ISLANDS') ~ 'CAYMAN ISLANDS',
    pm.address %in% c('WARWICK BERMUDA', 'SOUTHAMPTON BERMUDA', 'BERMUDA', 'SMITHS BERMUDA') ~ 'BERMUDA',
    pm.address %in% c('TURKU FINLAND', 'ESPOO FINLAND', 'HELSINKI UUSIMAA FINLAND', 'KEMI FINLAND', 'HELSINKI FINLAND') ~ 'FINLAND',
    pm.address == 'PORT AU-PRINCE HAITI' ~ 'HAITI',
    pm.address %in% c('BULAWYO ZIMBABWE', 'HARARE ZIMBABWE') ~ 'ZIMBABWE',
    pm.address == 'CASTRIES SAINT LUCIA' ~ 'SAINT LUCIA',
    pm.address %in% c('BRATISLAVA SLOVAKIA', 'KOSICE SLOVAKIA', 'BANOVCE NAD BEBRAVOU SLOVAKIA') ~ 'SLOVAKIA',
    pm.address %in% c('HONG KONG', 'BEIJING CHINA', 'SAI KUNG HONG KONG') ~ 'CHINA',
    pm.address %in% c('BELFAST NORTHERN IRELAND', 'HOLLYWOOD NORTHERN IRELAND', 'DERRY NORTHERN IRELAND') ~ 'NORTHERN IRELAND',
    pm.address == 'BEIRUT LEBANON' ~ 'LEBANON',
    pm.address == 'LA PAZ BOLIVIA' ~ 'BOLIVIA',
    pm.address == 'JUBA SOUTH SUDAN' ~ 'SOUTH SUDAN',
    pm.address %in% c('CARDIFF WALES', 'BANGOR WALES', 'NEWPORT WALES UNITED KINGDOM', 'PORTHCAWL WALES', 'NEWPORT UK') ~ 'WALES',
    pm.address == 'TARTU ESTONIA' ~ 'ESTONIA',
    pm.address %in% c('SOFIA BULGARIA', 'PLOVDIV BULGARIA') ~ 'BULGARIA',
    pm.address %in% c('VILNIUS LITHUANIA', 'KLAIPEDA LITHUANIA') ~ 'LITHUANIA',
    pm.address == 'GIBRALTAR GIBRALTAR' ~ 'GIBRALTAR',
    pm.address == 'HYDERABAD INDIA' ~ 'INDIA',
    pm.address == 'SAN SALVADOR EL SALVADOR' ~ 'EL SALVADOR',
    pm.address == 'TAIPEI TAIWAN' ~ 'TAIWAN',
    pm.address == 'GJILANI KOSOVO' ~ 'KOSOVO',
    pm.address %in% c('SINGAPORE', 'SINGAPORE CITY SINGAPORE') ~ 'SINGAPORE',
    pm.address == 'BOBO DIOULASSO BURKINA FASO' ~ 'BURKINA FASO',
    pm.address == 'DUBAI UNITED ARAB EMIRATES' ~ 'UNITED ARAB EMIRATES',
    pm.address %in% c('SANTO AÑTAO CAPE VERDE', 'FOGO CAPE VERDE') ~ 'CAPE VERDE',
    pm.address == 'CAIRO EGYPT' ~ 'EGYPT',
    pm.address == 'DERNAH LIBYA' ~ 'LIBYA',
    pm.address == 'MONACO' ~ 'MONACO',
    pm.address %in% c('ABIDJAN IVORY COAST', "'ABIDJAN COTE D'IVOIRE'") ~ 'IVORY COAST',
    pm.address == 'PANAMA CITY PANAMA' ~ 'PANAMA',
    pm.address == 'GABORONE BOTSWANA' ~ 'BOTSWANA',
    pm.address == 'PLOIESTI ROMANIA' ~ 'ROMANIA',
    pm.address %in% c('ISTANBUL TURKEY', 'ISMIR TURKIYE') ~ 'TURKEY',
    pm.address == 'WOLAYTA SODO ETHIOPIA' ~ 'ETHIOPIA',
    pm.address %in% c('LUALA LUMPUR MALAYSIA', 'KUALA LUMPUR MALAYSIA') ~ 'MALAYSIA',
    pm.address == 'AMMAN JORDAN' ~ 'JORDAN',
    pm.address == 'BAGHDAD IRAQ' ~ 'IRAQ',
    pm.address == 'ZAMBIA' ~ 'ZAMBIA',
    pm.address == 'GUATEMALA CITY GUATEMALA' ~ 'GUATEMALA',
    pm.address == 'DOUGLAS BRITISH ISLES' ~ 'ISLE OF MAN',
    temp == 'CANADA' ~ 'CANADA',
    temp %in% c('TRINIDAD & TOBAGO', 'TRINIDAD AND TOBAGO') ~ 'TRINIDAD AND TOBAGO',
    temp == 'ISRAEL' ~ 'ISRAEL',
    temp %in% c('BOSNIA AND HERZEGOVINA', 'AND HERZEGOVINA') ~ 'BOSNIA AND HERZEGOVINA',
    temp == 'TURKS & CAICOS' ~ 'TURKS & CAICOS',
    name %in% c('Ethan Kang', 'Alexander Henderson') ~ 'CANADA',
    name %in% c('Tobias  Wangerud', 'Kevin Ogudugu', 'Thomas Vold') ~ 'NORWAY',
    name == 'Davide  Romeo' ~ 'ITALY',
    name %in% c('Mathias Hille', 'Jackson Flier', 'Christoph Schurz', 'Isaiah Thomas', 'Henrik Weiper', 'Tobias Jahn', 'Kevin Thallinger') ~ 'GERMANY',
    name == 'Fraser Brown' ~ 'NEW ZEALAND',
    name %in% c('Brady Elmblad', 'Matty Gardner', 'Sebastian Montoulieu', 'Connor Lawlor', 'Gus Mendieta', 'Griffin Polinsky', 'Ethan Leary', 'Andrew Wilbert', 'Richard Conces', 'Kade Tepe', 'Neil Devnani', 'Jackson Flier', 'Ethan Franco', 'Alec Kenison', 'Harry Sankey', 'Jaden Prado', 'Jet Ulven', 'Sebastian Restrepo', 'Fabrizio Cubeddu', 'Tomas Sciarra', 'Colby Hegarty', 'Aidan Ahmad', 'Alex Robb', 'Ryan Savoie', 'Marco Brougher', 'Kevin Carmichael', 'Giancarlo Mota', 'Kai Djerbaka', 'Jack Bowers', 'Justin Knighton', 'Allan Juarez', 'Rohan McEligot', 'Kieran Bracken Serra', 'Arik Duncan', 'Wisdom Onuoma', 'Griffin Gustafson', 'Adrian Guzman', 'Eli Wachs', 'Kevin Rodriguez', 'Brendan Bell', 'Alfredo Ortiz', 'Nik Laredo', 'Owen Bizzaro', 'Cameron Robie', 'Connor Lambe', 'Malcolm Zalayet', 'Wyatt Meyer', 'Santiago Hopkins', 'Israel Cortez', 'Matthew McGrew', 'Beau Morrison', 'Arseni Metelitsa', 'Adrian Jacobs', 'Federico Barbieri', 'Michael Luckhurst', 'Noe Aubanel', 'Zack Andoh', 'Thomas Grimes', 'Iyke Dafe', 'Tanner Barry', 'Harri Sprofera', 'Taha Kina', 'Scott Gustafson', 'Lorenzo Amaral', 'Jack Cloherty', 'Carlo Brown', 'Charlie Adams', 'Jamin Gogo Peters', 'Keegan Walpole', 'Mike Balleani', 'Langdon Gryglas', 'Shayne Thompson', 'Gavin Tabije', 'Zion Wharton', 'Dylan Ellis', 'Adolfo Diaz', 'Timi Browne', 'Heechan Han', 'Diego Elizalde', 'Kyle Gee', 'Greyson Mitchell', 'Andre Romo', 'Levi Pillar', 'Carter Smith', 'Cal Walsh', 'Stefano DAgostini', 'David Blanton', 'Nicholas  Bianchi', 'Josh Mason', 'Alec Laible', 'Morris Matthews', 'Blair Camargo', 'Michael Guiry', 'Kasem Minzey', 'Justin Davidyock', 'Ryan Behrmann', 'Kai Thomas', 'Ronald Zhai', 'Miles Hadley', 'Jack Kryger', 'Curtis Boozer', 'Liam Tucker', 'Andrew Kim', 'Chase Ashby', 'Isaiah Easley', 'Ian Ngonethong', 'Declan Horio', 'Milan Uncanin', 'Evan Wellerstein', 'Quinn Sellers', 'Elijah Dinkel', 'Dylan Akau', 'Edgar Soto', 'Dylan Janoski', 'Chris Nezianya') ~ 'USA',
    name == 'Gaku Nishimura' ~ 'JAPAN',
    name == 'Nonso Adimabua' ~ 'NIGERIA',
    name == 'Joe Chalwin' ~ 'ENGLAND',
    name == 'Mads Stistrup Petersen' ~ 'DENMARK',
    name %in% c('Yousef Alsaidi', 'Andrew Hummell', 'Teagan Vail', 'Declan Vail', 'Jackson Wall', 'Neythan Yaucan', 'Yousef Alsaidi') ~ 'TEAM IMPACT',
    name == 'Yoann Araujo' ~ 'FRANCE',
    name %in% c('KK Baffour', 'Daniel Boateng') ~ 'GHANA',
    name == 'Abdoul Karim Pare' ~ 'IVORY COAST',
    name == 'Gijs Hovius' ~ 'NETHERLANDS',
    name == 'Jose Vilela' ~ 'PUERTO RICO',
    temp == 'PUERTO RICO' ~ 'PUERTO RICO',
    name == 'Guilherme Melchiori' ~ 'BRAZIL',
    TRUE ~ country
  ))

msoc_div1 <- msoc_div1 |>
  mutate(Continent = case_when(
    country %in% c('USA', 'CANADA', 'MEXICO', 'BERMUDA', 'PUERTO RICO', 'COSTA RICA', 'PANAMA', 'BAHAMAS', 'BARBADOS', 'CAYMAN ISLANDS', 'DOMINICAN REPUBLIC', 'EL SALVADOR', 'HAITI', 'GUATEMALA', 'HONDURAS', 'JAMAICA', 'SAINT LUCIA', 'TRINIDAD AND TOBAGO', 'TURKS & CAICOS') ~ 'North America',
    country %in% c('ARGENTINA', 'BOLIVIA', 'BRAZIL', 'CHILE', 'COLOMBIA', 'ECUADOR', 'PERU', 'PARAGUAY', 'VENEZUELA') ~ 'South America',
    country %in% c('ALBANIA', 'AUSTRIA', 'BELGIUM', 'BOSNIA AND HERZEGOVINA', 'BULGARIA', 'CROATIA', 'CYPRUs', 'DENMARK', 'ENGLAND', 'ESTONIA', 'FINLAND', 'FRANCE', 'GERMANY', 'GIBRALTAR', 'GREECE', 'HUNGARY', 'ICELAND', 'IRELAND', 'ITALY', 'KOSOVO', 'LUXEMBOURG', 'MONACO', 'NETHERLANDS', 'NORTH MACEDONIA', 'NORTHERN IRELAND', 'NORWAY', 'POLAND', 'PORTUGAL', 'ROMANIA', 'SCOTLAND', 'SERBIA', 'SLOVAKIA', 'SLOVENIA', 'SPAIN', 'SWEDEN', 'SWITZERLAND', 'THE CZECH REPUBLIC', 'UKRAINE', 'WALES', 'ISLE OF MAN', 'LITHUANIA', 'CYPRUS') ~ 'Europe',
    country %in% c('ZAMBIA', 'ZIMBABWE', 'BOTSWANA', 'BURKINA FASO', 'CAMEROON', 'CAPE VERDE', 'DR CONGO', 'EGYPT', 'ETHIOPIA', 'GAMBIA', 'GHANA', 'IVORY COAST', 'KENYA', 'LESOTHO', 'LIBERIA', 'LIBYA', 'MOROCCO', 'MOZAMBIQUE', 'NIGERIA', 'SENEGAL', 'SIERRA LEONE', 'SOUTH AFRICA', 'SOUTH SUDAN', 'TANZANIA', 'TOGO', 'UGANDA') ~ 'Africa',
    country %in% c('JAPAN', 'CHINA', 'INDIA', 'ISRAEL', 'IRAQ', 'JORDAN', 'LEBANON', 'MALAYSIA', 'MONGOLIA', 'RUSSIA', 'SINGAPORE', 'SOUTH KOREA', 'TAIWAN', 'TURKEY', 'UNITED ARAB EMIRATES') ~ 'Asia',
    country %in% c('AUSTRALIA', 'NEW ZEALAND') ~ 'Oceania',
  ))
```

```{r}
msoc_div1_europe <- msoc_div1 |>
  filter(Continent == 'Europe') |>
  mutate(Region = case_when(
    country %in% c('ALBANIA', 'BOSNIA AND HERZEGOVINA', 'CROATIA', 'GREECE', 'ITALY', 'NORTH MACEDONIA', 'PORTUGAL', 'SERBIA', 'SLOVENIA', 'SPAIN', 'CYPRUS', 'BULGARIA', 'ROMANIA', 'KOSOVO', 'GIBRALTAR') ~ 'Southern Europe',
    country %in% c('GERMANY', 'POLAND', 'SWITZERLAND', 'AUSTRIA', 'SLOVAKIA', 'HUNGARY', 'THE CZECH REPUBLIC', 'UKRAINE') ~ 'Eastern Europe',
    country %in% c('NORWAY', 'SWEDEN', 'DENMARK', 'FINLAND', 'ICELAND', 'ENGLAND', 'WALES', 'NORTHERN IRELAND', 'SCOTLAND', 'IRELAND', 'LITHUANIA', 'ESTONIA', 'ISLE OF MAN') ~ 'Northern Europe',
    country %in% c('AUSTRIA', 'BELGIUM', 'FRANCE', 'LUXEMBOURG', 'MONACO', 'NETHERLANDS') ~ 'Western Europe'
  ))
```

###Cleaning player heights
  ##Need to finish with players who don't have height listed on profile
```{r}
msoc_div1 <- msoc_div1 |>
  mutate(HeightCleaned = case_when(
    height %in% c("5\'4\"", '5-4', "5\' 4\''") ~ "\'5-4\'",
    height %in% c("5\'2\"", '5-2', "5\' 2\''") ~ "\'5-2\'",
    height %in% c("5\'5\"", '5-5', "5\' 5\''") ~ "\'5-5\'",
    height %in% c("5\'3\"", '5-3') ~ "\'5-3\'",
    height %in% c("5\'9\"", '5-9', "5\' 9\''") ~ "\'5-9\'",
    height %in% c("5\'6\"", '5-6', "5\' 6\''") ~ "\'5-6\'",
    height %in% c("5\'7\"", '5-7', "5\' 7\''") ~ "\'5-7\'",
    height %in% c("5\'8\"", '5-8', "5\' 8\''") ~ "\'5-8\'",
    height %in% c("5\'10\"", '5-10', "5\' 10\''") ~ "\'5-10\'",
    height %in% c("5\'11\"", '5-11', "5\'111\"", "5\ 11\''") ~ "\'5-11\'",
    height %in% c("6\'0\"", '6-0', "6\' 0\''") ~ "\'6-0\'",
    height %in% c("6\'1\"", '6-1', "6\' 1\''") ~ "\'6-1\'",
    height %in% c("6\'2\"", '6-2', "6\' 2\''") ~ "\'6-2\'",
    height %in% c("6\'3\"", '6-3', "6\' 3\''") ~ "\'6-3\'",
    height %in% c("6\'4\"", '6-4') ~ "\'6-4\'",
    height %in% c("6\'5\"", '6-5') ~ "\'6-5\'",
    height %in% c("6\'6\"", '6-6') ~ "\'6-6\'",
    height %in% c("6\'7\"", '6-7') ~ "\'6-7\'"
  ))
```

###Cleaning player classes
  ##All Cleaned
```{r}
msoc_div1 <- msoc_div1 |>
  mutate(ClassCleaned = case_when(
    class %in% c('Fr.', 'R-Fr.', 'FR', 'Freshman', 'Redshirt Freshman', 'Fy.', 'FY', 'Rf.', 'Fy') ~ 'Freshmen',
    class %in% c('So.', 'R-So.', 'SO', 'Sophomore', 'Redshirt Sophomore', 'RS So.') ~ 'Sophomore',
    class %in% c('Jr.', 'R-Jr.', 'JR', 'Junior', 'Redshirt Junior', 'R-Jr', 'RS JR') ~ 'Junior',
    class %in% c('Sr.', 'R-Sr.', 'SR', 'Senior', 'Redshirt Senior') ~ 'Senior',
    class %in% c('Gr.', 'R-Gr.', 'GR', 'Grad.','Graduate Student', 'Redshirt Graduate Student', 'Fifth Year', '5th', '6th', 'Sr.+', '5th.') ~ 'Graduate Student',
    name %in% c('Henrik Weiper') ~ 'Junior',
    name %in% c('Iyke Dafe', 'Lorenzo Amaral', 'Carlo Brown', 'Shayne Thompson', 'Zion Wharton', 'Heechan Han', 'Diego Elizalde', 'Carter Smith') ~ 'Sophomore',
    name %in% c('Tanner Barry', 'Harri Sprofera', 'Jack Cloherty', 'Keegan Walpole', 'Mike Balleani', 'Gavin Tabije', 'Kyle Gee', 'Cal Walsh') ~ 'Senior',
    name %in% c('Taha Kina', 'Scott Gustafson', 'Charlie Adams', 'Levi Pillar') ~ 'Graduate Student',
    name %in% c('Jamin Gogo Peters', 'Mads Stistrup Petersen', 'Langdon Gryglas', 'Dylan Ellis', 'Adolfo Diaz', 'Greyson Mitchell') ~ 'Junior',
    name %in% c('Timi Browne', 'Andre Romo', 'Stefano DAgostini', 'Amoni Thomas') ~ 'Freshmen'
  ))

msoc_div1 |>
  group_by(ClassCleaned) |>
  summarise(
    total = n()
  )
```
-Freshmen is the most represented class, sophomore and junior are seperated by just two players.
- Seems once a player plays one or two seasons, they look for other opportunities outside of the college game


###Cleaning player positions
  ##Cleaned all players with listed positions
```{r}
msoc_div1 <- msoc_div1 |>
  mutate(PositionCleaned = case_when(
    position %in% c('Goalkeeper', 'GK', 'GOALKEEPER', 'G', 'Goaltender', 'Goal Keeper') ~ 'Goalie',
    position %in% c('Forward', 'Attack', 'F', 'FORWARD', 'F/FM', 'Striker', 'Winger-Forward', 'Winger', 'W', 'Wing', 'Foward') ~ 'Forward',
    position %in% c('Midfield', 'M', 'MIDFIELD', 'Midfielder', 'Central Midfielder', 'MF', 'CAM', 'Left Midfielder', 'Center Midfielder', 'Midfielder (Captain)') ~ 'Midfield',
    position %in% c('Defender', 'D', 'DEFENSE', 'Defense', 'Back', 'B', 'F/B', 'CB', 'LCB', 'Center Back', 'Outside Back', 'Left Back', 'Center/Left Back', 'Defense (Captain)', 'Centerback', 'Defender/Center Back') ~ 'Defense',
    position %in% c('Midfielder/Defender', 'D/M', 'B/M', 'Defender/Midfielder', 'M/D', 'MF/D', 'D/MF', 'Defender / Midfielder', 'Midfielder / Defender', 'Defense/Midfield', 'Midfield/Back', 'Defender/Midfielder (Captain)', 'Midfield/Defense (Captain)', 'Midfield/Defense', 'Midfielder/Back', 'Midfielder/Defense', 'Defense/Midfielder', 'Defender/Midfield', 'Midfield/Defender', 'Defender/Midfield', 'Defender/ Midfielder', 'Midfield / Defense', 'Defense / Midfield') ~ 'Midfield/Defense',
    position %in% c('F/M', 'Forward/Midfielder', 'Midfielder/Forward', 'MF/F', 'M/F', 'F/MF', 'For./Mid', 'FWD/MID', 'Forward/Midfield', 'Forward / Midfielder', 'Midfield/Forward', 'Midfielder / Forward', 'Midfielder-Striker', 'Forward/ Midfielder', 'Midfielder/ Forward', 'Forward / Midfield') ~ 'Forward/Midfield',
    position %in% c('F/D', 'Defender/Forward', 'Forward/Defense', 'Forward / Defender', 'Defender/Winger', 'Defense/Forward') ~ 'Forward/Defender'
  ))

msoc_div1 |>
  group_by(PositionCleaned) |>
  summarise(
    total = n()
  )
```
- More midfielders than any other position.
- Not many goalies rostered, which makes sense since each team only has two or three each season.


###Next Steps
I think for this part of the presentation I want to focus on player positions. I want to see if there are trends, like taller players as goalies or a certain class being a bulk of a position group.

From there, I want to look into the player position and continent data to see if one continent or country produces the most players for a certain position. I would love to show this data off in a map -- my initial thoughts were a map of each continent for each position group where a country is filled in, either light or dark, based on the number of players from each country. My next step will be working with the right package for making maps to display the player position data.
